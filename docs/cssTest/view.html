
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ğŸ´ æŠ•ç¨¿ã‚’è¦‹ã‚‹ | é£Ÿã®æ›¸</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body class="view">
  <header>
      <h1></h1>
  </header>
  <a class="back-link" href="${pageContext.request.contextPath}/posts">â† æŠ•ç¨¿ä¸€è¦§ã¸æˆ»ã‚‹</a>

  <div class="post-container">
      <!--ã‚¢ãƒ—ãƒªå…¨ä½“ã®ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ & DBã«ä¿å­˜ã•ã‚ŒãŸç”»åƒã®ç›¸å¯¾ãƒ‘ã‚¹ -->
      <img src="${pageContext.request.contextPath}/${post.imagePath}" class="post-image" alt="æŠ•ç¨¿ç”»åƒ"/>
      <p class="post-title">${post.title}</p>
      <p class="post-meta">
          by ${post.author} | <%= request.getAttribute("formattedDate") %>
      </p>
      <div class="post-content">${post.content}</div>
      <br>
      <a href="${pageContext.request.contextPath}/edit-post?id=${post.id}" class="edit-button">âœï¸ ç·¨é›†ã™ã‚‹</a>
      <form action="<%= request.getContextPath() %>/delete-post" method="post" >
          <input type="hidden" name="id" value="${post.id}">
          <button type="submit" class="delete-btn">ğŸ—‘ï¸ å‰Šé™¤</button>
      </form>

      <h3 class="view-subtitle">ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿</h3>

      <form action="${pageContext.request.contextPath}/add-comment" method="post">
          <!-- æŠ•ç¨¿IDã‚’éš ã—ã¦é€ä¿¡ -->
          <input type="hidden" name="postId" value="${post.id}"/>

          <!-- ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹ -->
          <textarea name="content" id="commentInput"
                    placeholder="ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„â€¦" rows="4"
                    maxlength="500" onclick="showExtraFields()" required></textarea>

          <!-- åå‰ -->
          <div id="extraFields" class="extraFields">
              <input type="text" name="author" id="nameInput" placeholder="ãŠåå‰ (ã«ã‚ƒã‚“ã“å¤§å¥½ã)" maxlength="50"
                     required/>

              <button type="button" class="close-btn" onclick="hideExtraFields()">Close</button>


              <button type="submit" class="submit-button">é€ä¿¡ã™ã‚‹</button>
          </div>
      </form>
      <br>

<!-- JavaScript -->
<script>
function showExtraFields() {
    let extraFields = document.getElementById("extraFields");
    let commentInput = document.getElementById("commentInput");

    if (!extraFields.classList.contains("show")) {
        extraFields.classList.add("show");
        commentInput.classList.add("expanded");
    }
}

function hideExtraFields() {
    let extraFields = document.getElementById("extraFields");
    let commentInput = document.getElementById("commentInput");

    if (extraFields.classList.contains("show")) {
        extraFields.classList.remove("show");
        commentInput.classList.remove("expanded");
    }
}
</script>



<h3 class="view-subtitle">ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§</h3>
<c:if test="${not empty comments}">
    <ul class="comment-list">
        <c:forEach var="comment" items="${comments}">
            <li class="comment-item">
                <p><strong><c:out value="${comment.author}" /></strong> ã•ã‚“ã‚ˆã‚Š</p>
                <p><c:out value="${comment.content}" /></p>
                <form action="${pageContext.request.contextPath}/delete-comment" method="post" onsubmit="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
                    <input type="hidden" name="commentId" value="${comment.id}" />
                    <input type="hidden" name="postId" value="${post.id}" />
                    <button type="submit" class="delete-btn">å‰Šé™¤</button>
                </form>
            </li>

        </c:forEach>
    </ul>
</c:if>
<c:if test="${empty comments}">
    <p>ã‚³ãƒ¡ãƒ³ãƒˆã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
</c:if>
</div>
</body>
</html>
